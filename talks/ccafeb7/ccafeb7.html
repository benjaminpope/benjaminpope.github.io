<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>CCA Stars Meeting Feb 7: Benjamin Pope</title>

		<meta name="description" content="Math and Data Talk">
		<meta name="author" content="Benjamin Pope">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<!-- <link rel="stylesheet" href="css/theme/black.css" id="theme"> -->
	<link rel="stylesheet" href="css/theme/black.css" id="theme">
		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>
	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-background="./pleiades.jpg">

					<section>
					<h2>Total Variation Minimization Photometry</h2>
					<h3>Benjamin Pope, NYU</h3>
					<h4>CCA Stars Meeting</h4>
					<h4>Feb 7 2018</h4>

					<!-- <p>
						<small>Created by <a href="http://hakim.se">Hakim El Hattab</a> / <a href="http://twitter.com/hakimel">@hakimel</a></small>
					</p> -->
					</section>

					<section data-state="dim-background">
						Slides available at <br><a href="benjaminpope.github.io/talks/ccafeb7/ccafeb7">benjaminpope.github.io/talks/ccafeb7/ccafeb7</a>
					</section>
				</section>


				<section data-background="./k2concept.jpg">
					<section>
						<h2><i>Kepler</i> Photometry</h2>
					</section>

					<section data-state="dim-background">
						The <a href="https://www.nasa.gov/mission_pages/kepler/main/index.html"><i>Kepler Space Telescope</i></a>, launched in 2009, looks for planets by the transit method, and also does asteroseismology.
					</section>

					<section data-state="dim-background">
						After the failure of a reaction wheel in 2012, it is now operating as the '<a href="https://www.nasa.gov/feature/ames/nasas-k2-mission-the-kepler-space-telescopes-second-chance-to-shine/">K2 Mission</a>', with very unstable pointing (hence the shaking in the <a href="https://github.com/KeplerGO/k2flix" title="made using Geert Barentsen's code here">videos</a> you'll see).
					</section>

					<section data-state="dim-background">
						<video width="480" height="480" controls autoplay loop>
						<source src="./epic_212521166.mp4" type="video/mp4">
						</video>					
					</section>

					<section data-state="dim-background">
						To get the photometry, you can just sum the pixel values in a window containing the whole PSF...
						<p class="fragment">but the pixels have different gains ("inter- and intra-pixel sensitivity variation")... </p>
						<p class="fragment">and the pixel window doesn't necessarily track the whole PSF perfectly ("aperture losses").</p>
					</section>

					<section data-state="dim-background">
						The <a href="https://github.com/rodluger/everest">EVEREST</a> model (<a href="http://adsabs.harvard.edu/abs/2016AJ....152..100L">Luger et al, 2016</a>) does 'pixel-level decorrelation', fitting a linear combination of pixel time series to the data, getting excellent photometry. 
						<p class="fragment">We will be motivated by this here.</p>
					</section>

					<section data-state="dim-background">
						For sufficiently bright stars, though, light fills the CCD wells with electrons that spill up and down the column, ruining the photometry as they leave the aperture.
					</section>

					<section data-state="dim-background">
						<video width="480" height="480" controls autoplay loop>
						<source src="./bright.mp4" type="video/mp4">
						</video>			
					</section>

					<section data-state="dim-background"> 
					<i>Kepler</i> saturates on stars brighter than ~ 11th mag (log scale: 5 mag = factor of 100) - but we want to look at stars 10k times brighter.
					</section>

				</section>

				<section data-background="./starry.jpg">

					<section>
						<h2>Halo Photometry</h2>
					</section>

					<section data-state="dim-background">
						What if we just look at unsaturated pixels?
					</section>

					<section data-state="dim-background">
						<video width="480" height="480" controls autoplay loop>
						<source src="./aldebaran.mp4" type="video/mp4">
						</video>
					</section>

					<section data-state="dim-background">
						Flux \(f_i \) at cadence i is a sum over j pixels \(p_{ij}\) with weights \(w_j\):
						<br><br>
						\[
						f_i \equiv \sum\limits_i w_j p_{ij}
						 \]
					</section>

					<section data-state="dim-background">
						In the <a href="https://github.com/davidwhogg/OWL">OWL</a> method (Hogg & Foreman-Mackey), you choose weights to minimize variance of the final light curve - but this has limited success.
					</section>

					<section data-state="dim-background">
						To find the appropriate weights, we instead minimize the Total Variation 
						<!-- <br><br> -->
						<p class="fragment">\[\begin{align}
						TV \equiv \dfrac{\sum_i |f_i - f_{i-1}|} {\sum_i f_i }
						\end{align} \]
						</p>
						<p class="fragment">This is the L1 norm on the derivative of the time series.</p>
						<p class="fragment">This has analytic derivatives in Theano - easy to optimize.</p>
					</section>

					<section>
						TV is widely used as a regularizer for reconstructing stepwise constant functions because it imposes sparsity on the derivative in a compressed-sensing framework.
						<p class="fragment"><i>Kepler</i> light curves are <i>not</i> sparse in the derivative.</p>
					</section>

					<section data-state="dim-background">
						Note that these light curves are basically a sum of sine waves - anything but sparse in the derivative! 
						<p class="fragment">But they're sparse in the Fourier domain... perhaps this is relevant?</p>
					</section>

					<section data-state="dim-background">
						<img width='800' height='390' data-src="combined.png" alt="Combined Figure">
						<p>Atlas lightcurve: raw (top) and halo (bottom)</p>
						<p><a href="http://adsabs.harvard.edu/abs/2017MNRAS.471.2882W">White, Pope et al., 2017</a></p>
					</section>

					<section data-state="dim-background">

						<img width='288' height='432' data-src="timeseries.jpg" alt="Combined Figure"><img width='288' height='432' data-src="ampspec.jpg" alt="Combined Figure">
						<p>Lightcurves of All Seven Bright Pleiades</p>
						<p><a href="http://adsabs.harvard.edu/abs/2017MNRAS.471.2882W">White, Pope et al., 2017</a></p>
						
					</section>


					<section data-state="dim-background">
						I have done some tests to examine why this works...
					</section>

					<section data-state="dim-background">
						Tim White observed that short-cadence K2 data doesn't converge well, but if you train the weights on long-cadence data it applies well enough to short-cadence. (I don't have a figure for this, just Tim's comment).
					</section>					

					<section data-state="dim-background">
						I wanted to know if this was because of the level of correlation between adjacent datapoints, so I simulated some data. I moved the PSF around in a slow circle and simulated steadily increasing amounts of white noise on this while keeping the range constant, so that I could change continuously from very-correlated to uncorrelated positions.
					</section>	

					<section data-state="dim-background">
						<pre><code data-trim data-noescape>
						x, y = np.sin(2*np.pi*t/20.), np.cos(2*np.pi*t/20.) # smooth
						f = 20*np.ones(ncad) + np.sin(t) 
						f[400:500] *= 0.9 # toy transit

						log_snrs = np.linspace(-3, 3,100)

						for jj, snr in enumerate(log_snrs):

							xx, yy = x + xamp*(10**snr)*np.random.randn(len(x)), y + yamp*(10**snr)*np.random.randn(len(y))

						### ... [guts of loop etc]

						</code></pre>
					</section>	

					<section>
						<img width='800' height='600' data-src="snr_sweep.png" alt="CDPP Sweep">
					</section>

					<section>
						<img width='800' height='600' data-src="snr_sweep_mad.png" alt="MAD Sweep">
					</section>

					<section>
						So total variation minimization works <i>way better</i> if you dither. 
					</section>

					<section>
						I wanted to check whether this was a frequency-dependent effect so I tried comparing a sinusoidal input light curve and sinusoidal xy with different frequencies.
					</section>

					<section>
						<img width='800' height='600' data-src="period_double.png" alt="CDPP Sweep">
					</section>

					<section>
						<img width='800' height='600' data-src="period_double_mad.png" alt="MAD Sweep">
					</section>


				</section>

				<section data-background="./pleiades.jpg">

					<section>
						<h3>Pleiades</h3>
						<p>Πλειάδες, the Seven Sisters</p>
						<p class="fragment">Alcyone, Atlas (dad), Electra, Maia, Merope, Taygeta, Pleione (mum)</p>
					</section>

					<section data-state="dim-background">
					<img width='800' height='390' data-src="combined.png" alt="Combined Figure">
					<p>Atlas lightcurve: raw (top) and halo (bottom)</p>
					<p><a href="http://adsabs.harvard.edu/abs/2017MNRAS.471.2882W">White, Pope et al., 2017</a></p>
					</section>

					<section data-state="dim-background">

						<img width='288' height='432' data-src="timeseries.jpg" alt="Combined Figure"><img width='288' height='432' data-src="ampspec.jpg" alt="Combined Figure">
						<p>Lightcurves of All Seven Bright Pleiades</p>
						<p><a href="http://adsabs.harvard.edu/abs/2017MNRAS.471.2882W">White, Pope et al., 2017</a></p>
						
					</section>

					<section data-state="dim-background">
						<p>I am currently searching all bright stars in K2 for transiting planets - none so far, but plenty of asteroseismology!</p>
					</section>

				</section>


				<section data-background="exoplanet.jpg" data-state="dim-background">
					<section>
						<h2>The Future</h2>
					</section>
					
					<section>
						The method generalizes well to simulated data for the upcoming <a href="https://tess.gsfc.nasa.gov/">TESS mission</a>. We have many K2 halo datasets and are working our way through them - between these missions we should cover the whole sky.
					</section>

					<section>
						We still don't have an explanation for the unreasonable effectiveness of the L1 norm in this algorithm - help us understand!
					</section>

					<section>
						All our code is open source at <a href="https://github.com/hvidy/halophot">github.com/hvidy/halophot</a> - play with it!
					</section>

					<section>
						We have a solution looking for problems - we want to extend this to TESS, JWST, and even ground-based missions. 
						<p class="fragment">We need your help to be able to understand and improve photometry tools.</p>
					</section>


				</section>


			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

					math: {
						mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
						config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
					},



				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/math/math.js', async: true }
				]
			});

		</script>

	</body>
</html>
